<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="topic-type" content="topic">

<meta name="product" content="MAYAUL">
<meta name="release" content="2025">
<meta name="book" content="GeneralUser">
<meta name="component" content="Maya-Scripting">
<meta name="created" content="30/7/2024">
<meta name="generatedby" content="TRIDION">
<meta name="user-comments" content="disable">
<meta name="modified" content="03/11/2022">
<meta name="topicid" content="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D">
<meta name="language" content="CHS">
<title>状态机示例：交互式教程</title>

	<link rel="stylesheet" type="text/css" href="../style/client.css">
	<script type="text/javascript" src="../scripts/client.js"><!--filler--></script>
</head>
<body id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D">
<div class="head"><div class="head-block"><div class="button-info"><span id="infoline"> </span></div>
<div class="ancestry"> </div>
<div class="head-text"><h1>状态机示例：交互式教程</h1></div>
</div>
</div>

<div class="body"><div class="p"> 状态机最有用的应用之一是构建交互式教程。要开始构建，可以加载以下任一项：
	 <ul class="ul" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__UL_3647D190F99B44718FAC27310E035BAC"><li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_CC1F804A3AAF4A3BAC2C70C8DFDFC491">位于<a class="xref" href="https://beehive.autodesk.com/community/service/rest/cloudhelp/resource/cloudhelpchannel/guidcrossbook/?v=2025&amp;p=MAYAUL&amp;l=CHS&amp;accessmode=live&amp;guid=GUID-9221B2E8-7E68-4ECB-94DC-ABEB21E956BF">内容浏览器</a>中的 TutorialBuldingDemo 文件。
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_70EA3376DC884AEB93AB8927776BF6A1">通过应用程序主页的“快速入门”(Getting Started)选项卡提供的交互式基础知识教程。
		</li>
</ul>
 
	 </div>
<div class="p">这两个文件的结构相似，因此无论您选择哪个文件，都可以通过执行以下操作快速开始：
	 <p class="li listintro">查看状态机</p>
<ol class="ol" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__OL_593D90014130467FAE548DBE014059D5"><li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_76B07973A6734392B3D296A4B8B73230">在大纲视图中，关闭<span class="ph menucascade"><span class="ph uicontrol">“显示</span> &gt; <span class="ph uicontrol">仅 DAG 对象”(Display &gt; DAG Objects Only)</span></span>。
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_2951688410F748E0A1C2E192F35E3DE7">按“阶段”(stage)一词进行过滤。
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_30CC867AD7CC4D03B49B577BBECA6757">选择所有阶段节点。
		  <div class="note note" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__GUID-2DC85D36-5C15-4636-9629-76936D0392F7"><span class="notetitle">注：</span> 除了阶段节点，还会有许多“activate_stage”节点。您不必担心这些。
		  </div>
 
		  <div class="fig fignone" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__FIG_B2AD3F7914D24D65BD078D8CC8C55230"><img class="image" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__IMAGE_6F86D015B64B47C599BD0AA82C61630E" src="../images/GUID-BA40A19C-0EC0-4453-B4FB-C031A4B3414A.png"></div>
 
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_96D9CDB521B04585B701482C480EC31F">打开<span class="ph menucascade"><span class="ph uicontrol">“窗口</span> &gt; <span class="ph uicontrol">节点编辑器”(Windows &gt; Node Editor)</span></span>。
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_27A225E9DB524206B043BADEB77B8DF4">单击<span class="ph uicontrol">“显示输入/输出”(Show Inputs/Outputs)</span>按钮 (<img class="image" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__IMAGE_43E8B02D3A2641B5B27D3A302E212523" src="../images/GUID-2DAD0BAA-9888-4075-B3DB-3C45B5CF4481.png">) 以显示阶段节点及其连接。
		</li>
</ol>
 
	 </div>
<div class="p"> 
		<div class="fig fignone" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__FIG_097FD1775FB34A0DB8A815A15BB17CC6"><img class="image" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__IMAGE_EAFA4C23EFFF46E3AD7D259FBD8AFF44" src="../images/GUID-6A57BF03-38DF-49F6-BA3C-13709F1EF942.png"></div>
此时，您可以看到教程阶段节点的结构。需要注意的一些重要事项包括：
	 <ul class="ul" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__UL_A47EECA24AE64F109AD433DBAB92B1CB"><li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_0A462D8E458F402B9F88C92BAFD6D58C"><span class="ph uicontrol">激活脚本时(On Activate Script)</span>：这是每个阶段的大部分工作发生时的脚本节点。可以在<a class="xref" href="https://help.autodesk.com/cloudhelp/2025/CHS/Maya-Scripting/files/GUID-EF3F2007-74E7-4F23-B4A3-8D2EF94579A1.htm">表达式编辑器</a>中查看 Python 代码（请参见下文）。
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_605F86CADC094D44B566C144B9B2C5B7"><span class="ph uicontrol">取消激活脚本时(On Deactivate Script)</span>：在此处连接一个脚本节点，以便在某个阶段完成后进行清理。尝试保持阶段逻辑独立，以便可以根据需要轻松移动或插入/删除它们，这是一个很好的做法。在上面的示例中，很明显在开发过程中，在 stage0 和 stage1 之间插入了 stage0_1。设计一个可供所有阶段节点使用的通用取消激活脚本也非常方便，让您可以简单地将所有<span class="ph uicontrol">“取消激活脚本时”(On Deactivate Script)</span>属性连接到链中以提高可读性。
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_AC811A332F4D4E45B2CB193F6EA71B73"><span class="ph uicontrol">时间滑块书签(Time Slider Bookmark)</span>：这在阶段开始时设置动画非常方便，但也可用于将场景状态从一个阶段更改为另一个阶段。例如，可以在书签开头为活动摄影机设置关键帧，使摄影机在阶段开始时跳转到场景中的不同位置。或者，可以为对象设置关键帧的可见性，使其在一个阶段中显示，但在另一个阶段中不显示。
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_8470228CED7C45EAA1C0A0336BFB8B38">阶段进展：根据阶段目标的不同，进入下一阶段的方式会有所不同。一些最常见的方式包括：
		  <ul class="ul" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__UL_FDB23446179140E58FB5B6E368334057"><li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_B18FB55A55FE48CA9C4124BF95B8C29C">激活阶段的<span class="ph uicontrol">“条件”(Condition)</span>属性或使用“-next”标志：如果需要在发生任何类型的事件时（例如，当用户单击自定义窗口或其他 UI 构件上的某个按钮时）触发下一个阶段，或者当它们满足某种条件时（例如，将对象移动到特定位置或打开特定编辑器），请使用此方法。在后一种情况下，可能需要将命令嵌入到 scriptJob 中，以便侦听这些事件。
			 </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_6D2F48F3CBDC44E29564EE9A6B02FA61">激活阶段的<span class="ph uicontrol">“动画结束”(End of Animation)</span>属性：用于简单地向用户演示某些内容的阶段。一旦时间滑块播放到末尾，下一个阶段将自动激活。
			 </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_3C4FBDA8450C45A69BD8A08A83CF970B">设置非零<span class="ph uicontrol">“延迟”(Delay)</span>值：用于为阶段指定在自动进入下一个阶段之前的时间限制。如果要为用户指定在继续操作之前浏览的有限时间，则该选项非常有用。
			 </li>
</ul>
 
		</li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_B1EE5512082A4CA28D20ACCB3F7A1DFB">在 UI 上显示二维文本或图像：这是为用户提供说明和提示的最佳方式。在上面的示例文件中，可以在以下脚本节点中找到覆盖源代码：
		  <ul class="ul" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__UL_02D1B207F9B64B7FA89B73F8D6191B15"><li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_104648038C45402C9482707B0EEDBE4D">overlayBubble 
			 </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_9E514392012C4D4491AE1A2A5153B23C">overlayDialog 
			 </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_C160E718CEBD4A67BF1043F7F10D813D">controller 
			 </li>
</ul>
Maya 中还包含一个演示，向您展示还可以使用代码运行哪些功能：<pre class="pre codeblock">import moverlay
moverlay.mayaDemo.demoOverlays()
</pre>
您可以在安装目录的 <span class="ph filepath">/Python/Lib/site-packages/moverlay</span> 文件夹中找到演示的源代码以及 moverlay 模块本身。有关二维叠加的详细信息，请参见<a class="xref" href="https://help.autodesk.com/cloudhelp/2025/CHS/Maya-Scripting/files/GUID-77D2AC6E-97D2-41FC-8FF8-A86410093708.htm">显示二维叠加</a>。
		</li>
</ul>
 
	 </div>
<div class="section" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__SECTION_847D71D8DC62402BB314A369E60A9B60"><h2 class="title sectiontitle">查看激活/取消激活脚本</h2> 
		 
		<div class="p">阶段的大多数工作都在其连接的脚本节点中进行。在上述两个示例文件中，这些文件通常命名为“activate_stage#”或“deactivate_stage#”。还有许多辅助对象脚本未连接到阶段，但阶段通常会调用它们来执行一些常见任务。一些示例包括：
		<ul class="ul" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__UL_FB860900FCC84C01A304F0C899544E19"><li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_7FD04FE29DF84225B70FA96E99632E65">overlayBubble：处理在屏幕上绘制词语气泡样式的叠加层。
		  </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_BF5D422A75314B1DA07A92C11B84333B">overlayDialog：处理在屏幕上绘制对话框样式的叠加层。与气泡不同，这些对话框可以移动和关闭。
		  </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_C45F7CB1A06A409F99C62AF1AA44E21D">clearOverlays：删除所有气泡样式的叠加层。
		  </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_56A34A8CCC2B4BD19EC46148EA4F1C97">clearDialogs：删除所有对话框样式的叠加层。
		  </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_DA78CD77433248349741E32CCA128A31">populateText：包含教程的所有文本的词典，可通过阶段名称引用该词典。
		  </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_557CC19EB7FA47F785B940B64A4CD3DA">updateController：刷新控制器的文本和可见性。
		  </li>
</ul>
 
		<p class="li listintro">查看教程的所有脚本</p>
<ol class="ol" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__OL_A935A71AD824435FAD80E14839C15533"><li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_AB20094313F74B2C9A94C131611B0DE1">打开<span class="ph menucascade"><span class="ph uicontrol">“窗口</span> &gt; <span class="ph uicontrol">动画编辑器</span> &gt; <span class="ph uicontrol">表达式编辑器”(Windows &gt; Animation Editors &gt; Expression Editor)</span></span>。
		  </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_18AC62EB4F5F46D4AA523B37EF77E577">单击<span class="ph menucascade"><span class="ph uicontrol">“选择过滤器</span> &gt; <span class="ph uicontrol">按脚本节点名称”(Select Filter &gt; By Script Node Name)</span></span>。
		  </li>
<li class="li" id="GUID-113DD257-7995-4B35-BF2F-860ECD19B19D__LI_3ABD6FEB9D754113B7673C8B31E64D2D">在左上角的列中选择脚本以查看其内容。
		  </li>
</ol>
 
		</div>
 
	 </div>
<p class="p">为了方便起见，两个示例文件已完全添加注释和记录。
	 </p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a class="link" href="https://help.autodesk.com/cloudhelp/2025/CHS/Maya-Scripting/files/GUID-D54C88C6-FD6A-46EE-A8B8-D41D83D9A3D0.htm">构建 Python 状态机</a></div>
</div>
</div>

</body>
</html>